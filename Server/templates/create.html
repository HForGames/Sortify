<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="{{ url_for('static', filename='dist/style.css') }}">
        <script src="{{ url_for('static', filename='dist/draggable.js') }}" defer></script>
        <link rel="shortcut icon" type="image/png" href="{{ url_for('static', filename='src/icon.png') }}">
        <link rel="preload" href="../static/src/header.png" as="image">
        <meta name="description" content="" />
        <meta name="keywords" content="" />
        <title>Dashboard</title>
        <style>
            @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap");

            html {
                font-family: "Poppins", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            }
        </style>
        <script>
            var genres = [];
            var index = 0;
        </script>
    </head>
    
    <body class="bg-cover bg-fixed h-screen text-white overflow-hidden" style="background-image : url('../static/src/header.png')">
        
        <div class="pt-4 container mx-auto">
            <h1 class="my-4 text-5xl md:text-8xl text-white opacity-75 font-bold leading-tight text-center md:text-left">
                <span class="bg-clip-text text-transparent bg-gradient-to-r from-green-400 via-pink-500 to-purple-500">
                Last</span> step
            </h1>
            <p class="text-white text-sm sm:text-lg md:text-1xl lg:text-2xl pt-5 text-center md:text-left">
                Choose the genres that you want to add to your new playlist by clicking on them.
            </p>
        </div>

        <div class="h-full grid grid-row grid-rows-3 grid-flow-col gap-4 container m-auto pt-8 pb-60 md:pb-80">
            <div class="bg-gray-800 bg-opacity-75 rounded-lg h-full w-full overflow-auto scrollbar justify-self-start row-span-2" style="direction:rtl;">
                <div class="m-10 grid grid-cols-1 lg:grid-cols-4 gap-y-2 gap-x-6" style="direction:ltr;">
                    {% for key in info %}
                        <label class="border-2 border-white border-opacity-20 pt-3 rounded-xl h-12 truncate text-justify hover:scale-105 duration-300 ease-in-out" onclick="myFunction('{{ key }}')" id="{{key}}" >
                            <span data-title"test" class="mx-4">{{key}}</span>
                        </label>
                    {% endfor %}
                    <script>
                        function myFunction(key) {
                            let j = 0;
                            if (document.getElementById(key).classList.contains("bg-gray-600")) {
                                document.getElementById(key).className = "border-2 border-white border-opacity-20 pt-3 rounded-xl h-12 truncate text-justify hover:scale-105 duration-300 ease-in-out";
                                for (let i = 0; genres[i]; i++) {
                                    if (genres[i] == key) {
                                        for (j = i; genres[j]; j++) {
                                            genres[j] = genres[j + 1];
                                        }
                                    }
                                }
                                index -= 1;
                                genres = genres.filter(element => {
                                    return element !== undefined;
                                });
                            } else {
                                document.getElementById(key).className += " scale-105 bg-gray-600";
                                genres[index] = key;
                                index += 1;
                            }
                            
                            if (genres.length === 0) {
                                document.getElementById("submit_button").className += " opacity-0";
                                document.getElementById("submit_button_inner").disabled = true;
                            } else {
                                document.getElementById("submit_button").className = "bg-gradient-to-r from-purple-800 to-green-500 hover:from-pink-500 hover:to-green-500 text-white font-bold py-2 px-3 rounded focus:ring transform transition hover:scale-105 duration-300 ease-in-out";
                                document.getElementById("submit_button_inner").disabled = false;
                            }
                            
                        }
                    </script>
                    <p id="demo"></p>
                </div>
            </div>

            <div class="rounded-lg h-full w-full grid grid-col grid-cols-2 gap-4">
                <div class="flex h-full justify-center items-center bg-gray-800 bg-opacity-75 rounded-lg">
                    <input type="text" id="idd" placeholder="Your Playlist name :" class="text-white text-sm font-bold sm:text-lg md:text-1xl lg:text-3xl text-center" style="background: transparent; border: none; background-color: transparent; resize: none; outline: none;">
                </div>
                <div class="flex h-full justify-center items-center bg-gray-800 bg-opacity-75 rounded-lg">
                    <div>
                        <form id="main_form"></form>
                        <a id="submit_button" class="bg-gradient-to-r from-purple-800 to-green-500 hover:from-pink-500 hover:to-green-500 text-white font-bold rounded focus:ring transform transition hover:scale-105 duration-300 ease-in-out opacity-0">
                            <button id="submit_button_inner" onclick="myfunction2()">Create your playlist</button>
                        </a>
                    </div>
                </div>
            </div>

            <script>
                document.getElementById("submit_button_inner").disabled = true;

                function myfunction2() {
                    let form = document.getElementById("main_form");
                    form.value = genres;
                    form.method = "POST";
                    for (let i = 0; genres[i]; i++) {
                        var element = document.createElement("input");
                        element.value = genres[i].toString();
                        element.name = genres[i].toString();
                        form.appendChild(element);  
                    }
                    /*
                    var element = document.createElement("input");
                    element.value = document.getElementById("idd").value;
                    element.name = document.getElementById("idd").value;
                    form.appendChild(element);
                    */
                    form.action = "/create/{{ playlist_id }}"; 
                    document.body.appendChild(form);
                    console.log(form.value)
                    form.submit();
                }
            </script>
        </div>

    </body>
</html>
    
<!--        
        document.getElementById(key.toString()).className += "scale-105";
    <form>
        {% for key in info %}
            {% for track in tracks %}
                {% for href in info[key] %}
                    {% if track['track']['href'] == href%}    
                        <a>{{ track['track']['name'] }}</a> <br>
                    {% endif %}
                {% endfor %}
            {% endfor %}
            <label>
                <span>{{key}}</span>
                <input type="checkbox" name="tag" value="{{key}}">
            </label>
            <br>
        {% endfor %}
        <input type="button" value="Submit">
    </form>
-->

<!--
     style="direction:rtl;"
                <div class="mx-10 grid grid-cols-1 gap-y-2" style="direction:ltr;">
                    {% for key in info %}
                        <label class="border-2 border-white border-opacity-20 pt-3 rounded-xl h-12 truncate text-justify hover:scale-105 duration-300 ease-in-out" onclick="myFunction('{{ key }}')" id="{{key}}" >
                            <span class="mx-4">{{key}}</span>
                        </label>
                    {% endfor %}
                    <script>
                        function myFunction(key) {
                            if (document.getElementById(key).classList.contains("bg-gray-600")) {
                                document.getElementById(key).className = "border-2 border-white border-opacity-20 pt-3 rounded-xl h-12 truncate text-justify hover:scale-105 duration-300 ease-in-out";
                            } else {
                                document.getElementById(key).className += " scale-105 bg-gray-600";
                            }
                        }
                    </script>
                    <p id="demo"></p>
                </div>
-->